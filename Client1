package Final;

import java.io.*;
import java.net.*;
import java.util.Scanner;

class Client {
	static class WriteThread implements Runnable {
		DataOutputStream outToServer;

		public WriteThread(DataOutputStream outToServer) {
			this.outToServer = outToServer;
		}

		public void run() {
			try {
				process();
			} catch (Exception e) {
				System.out.println(e.getMessage());
			}
		}

		private void process() throws Exception {
			Scanner scnr = new Scanner(System.in);
			while (true) {
				String quitMsg = scnr.nextLine();
				this.outToServer.writeBytes(quitMsg + "\r\n");
			}
		}
	}

	public static void main(String argv[]) throws Exception {
		Socket connectionSocket = new Socket("localhost", 1234);

		DataOutputStream outToServer = new DataOutputStream(connectionSocket.getOutputStream());
		BufferedReader inFromServer = new BufferedReader(new InputStreamReader(connectionSocket.getInputStream()));
		Scanner scnr = new Scanner(System.in);

		String welcomeMsg = inFromServer.readLine();
		System.out.println(welcomeMsg);
		String name = scnr.nextLine();
		outToServer.writeBytes(name + "\r\n");

		String helloMsg = inFromServer.readLine();
		System.out.println(helloMsg);

		String roleMessage = inFromServer.readLine();
		System.out.println(roleMessage);

		WriteThread write = new WriteThread(outToServer);
		Thread thread = new Thread(write);
		thread.start();

		String serverMessage = null;
		while (true) {
			while ((serverMessage = inFromServer.readLine()) != null) {
				System.out.println(serverMessage);

			}
		}
	}
}
